<h1 align="center">
    @DeleteMapping
    <img src="https://cdn4.iconfinder.com/data/icons/essentials-72/24/013_-_Trash-256.png" alt="routes icon" width="80px" align="center">
</h1>


Sempre que voc√™ for manipular dados de forma √∫nica, voce precisa primeiro verificar se aquele registro existe.

Ex:

- Selecionar um registro pelo #ID
- Deletar um registro pelo #ID
- Update de um registro pelo #ID

<br>

Antes de fazer qualquer uma dessas operacoes, precisamos verificar se existe um registro com o #ID informado.

Sempre vamos seguir o padrao de requests Restful:

<img src="../imgs/restFull_routes.jpg" alt="restful routes image" width="550px">

<hr>
<br>


## Deletando um Student
Para deletar um registro do banco, vamos criar uma rota `@DeleteMapping`.

<br>

### Controller

```java
@DeleteMapping("/students/{id}")
public void deleteStudent(@PathVariable("id") Long id){ //Esse par√¢metro vai vir da URL
    this.ss.deleteStudent(id);
}
```


<br>

### Service
- Antes de deletar, precisamos saber se existe um "Student" com o #ID informado na URL. Vamos usar o `.findById()`

- Se existir, deletamos do banco usando o `.deleteById()`


```java
public void deleteStudent(Long id){
    Optional<Student> sOptional = this.sr.findById(id);

    if(sOptional.isEmpty()){
        throw new IllegalStateException(String.format("Student #%d not found", id)); //essa class extends RunTimeException. Poderia ser direto a RuntimeException ou uma class que voce criasse que extendesse RuntimeException
    }
    this.sr.deleteById(id); //deletamos do banco
}
```

üìñ Quando usamos alguma Class filha / que extends `RuntimeException`, n√£o precisamos tratar o erro. Sempre d√™ prefer√™ncia para as `RuntimeException`.


<br>

### Repository
Podemos criar nosso proprio method `findById()`;

```java
@Query(nativeQuery = false, value = "SELECT s FROM Student s WHERE s.id = :id")
public Optional<Student> findById(@Param("id") Long id);
```


<br>

Podemos criar nosso proprio method `deleteById()`;

```java
// ========================================== DELETE ==========================================
@Modifying // Estamos dizendo que essa query √© sens√≠vel, pois vamos modificar um registro. No caso de update ou delete de um registro
@Query(nativeQuery = false, value = "DELETE FROM Student s WHERE s.id = :id")
public void deleteById(@Param("id") Long id);

```


‚ö†Ô∏è Sempre que vamos fazer uma `Query` sens√≠vel, como update ou delete de um registro, precisamos usar a annotation `@Modifying` na Query.